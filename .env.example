# Bifrost Environment Configuration
#
# Quick Start: Run ./setup.sh to generate this file with secure random secrets.
# Manual Setup: Copy this file to .env and customize as needed.
#
# All settings use BIFROST_ prefix for the API.
# Docker Compose also uses POSTGRES_PASSWORD and RABBITMQ_PASSWORD directly.

# =============================================================================
# Infrastructure Passwords (used by Docker Compose)
# =============================================================================
# Auto-generated by setup.sh - or set your own values
POSTGRES_PASSWORD=bifrost_dev
RABBITMQ_PASSWORD=bifrost_dev

# =============================================================================
# Core Settings
# =============================================================================
BIFROST_ENVIRONMENT=production
BIFROST_DEBUG=false
BIFROST_MAX_CONCURRENCY=10 # Determines how many jobs can be processed at once

# =============================================================================
# Development - VS Code Debugging
# =============================================================================
# Set to true to enable debugpy (API waits for VS Code debugger on port 5678)
# ENABLE_DEBUG=true

# =============================================================================
# Security - Secret Key
# =============================================================================
# Auto-generated by setup.sh - MUST change in production!
# Used for JWT signing and Fernet encryption of secrets.
# Must be at least 32 characters.
BIFROST_SECRET_KEY=dev-secret-key-change-in-production-must-be-32-chars

# =============================================================================
# Database (PostgreSQL)
# =============================================================================
# These are set automatically in docker-compose.yml, but can be overridden
# BIFROST_DATABASE_URL=postgresql+asyncpg://bifrost:bifrost_dev@postgres:5432/bifrost
# BIFROST_DATABASE_URL_SYNC=postgresql://bifrost:bifrost_dev@postgres:5432/bifrost
# BIFROST_DATABASE_POOL_SIZE=5
# BIFROST_DATABASE_MAX_OVERFLOW=10

# =============================================================================
# Message Queue (RabbitMQ)
# =============================================================================
# Set automatically in docker-compose.yml
# BIFROST_RABBITMQ_URL=amqp://bifrost:bifrost_dev@rabbitmq:5672/

# =============================================================================
# Cache & Sessions (Redis)
# =============================================================================
# Set automatically in docker-compose.yml
# BIFROST_REDIS_URL=redis://redis:6379/0

# =============================================================================
# JWT Token Settings
# =============================================================================
BIFROST_ACCESS_TOKEN_EXPIRE_MINUTES=30
BIFROST_REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# MFA Settings
# =============================================================================
BIFROST_MFA_ENABLED=true
BIFROST_MFA_TOTP_ISSUER=Bifrost
BIFROST_MFA_RECOVERY_CODE_COUNT=10
BIFROST_MFA_TRUSTED_DEVICE_DAYS=30

# =============================================================================
# WebAuthn/Passkeys Settings
# =============================================================================
# Passkeys provide passwordless login using biometrics (Face ID, Touch ID, etc.)
# The RP_ID must match your domain (e.g., "localhost" for dev, "app.example.com" for prod)
BIFROST_WEBAUTHN_RP_ID=localhost
BIFROST_WEBAUTHN_RP_NAME=Bifrost
BIFROST_WEBAUTHN_ORIGIN=http://localhost:3000

# =============================================================================
# Default Admin User (Optional)
# =============================================================================
# If set, creates this user on startup (skips setup wizard)
# Leave commented to use the setup wizard on first access
# BIFROST_DEFAULT_USER_EMAIL=admin@localhost
# BIFROST_DEFAULT_USER_PASSWORD=admin

# =============================================================================
# OAuth SSO (Microsoft, Google, OIDC)
# =============================================================================
# OAuth SSO providers are now configured via the Settings page in the UI.
# Navigate to Settings > SSO to configure Microsoft, Google, or custom OIDC providers.
# Credentials are stored encrypted in the database.

# =============================================================================
# S3-Compatible Object Storage
# =============================================================================
# Bifrost uses S3-compatible storage for workspace files (enables horizontal scaling).
#
# OPTION A: Local Development with MinIO (default in Docker Compose)
#   - Set MINIO_* variables below
#   - Docker Compose automatically maps these to BIFROST_S3_* for the API
#   - MinIO console available at http://localhost:9001
#
# OPTION B: Production with AWS S3, Azure Blob, or other S3-compatible storage
#   - Delete or comment out MINIO_* variables
#   - Set BIFROST_S3_* variables directly
#   - Set BIFROST_S3_ENDPOINT_URL empty for AWS S3 (uses default AWS endpoints)

# --- MinIO Configuration (for local Docker development) ---
MINIO_ROOT_USER=bifrost
MINIO_ROOT_PASSWORD=bifrost_dev

# --- S3 Configuration (override for production, or leave for Docker defaults) ---
# BIFROST_S3_BUCKET=bifrost-local
# BIFROST_S3_ENDPOINT_URL=http://minio:9000
# BIFROST_S3_ACCESS_KEY=bifrost
# BIFROST_S3_SECRET_KEY=<same-as-MINIO_ROOT_PASSWORD>
# BIFROST_S3_REGION=us-east-1

# =============================================================================
# Server Settings
# =============================================================================
BIFROST_HOST=0.0.0.0
BIFROST_PORT=8000

# MCP
BIFROST_MCP_BASE_URL=https://bifrost.yourpublicdomain.com